
DROP TABLE CLASSSTYLE;
DROP TABLE ShoppingMall;
DROP TABLE PROMOTION ;
DROP TABLE PROMOTIONDETAIL ;

CREATE TABLE CLASSSTYLE (
CLASSNO      NUMBER(10)  PRIMARY KEY ,
CLASSNAME  VARCHAR2(15) NOT NULL
);

CREATE TABLE MEMBER(
MEMBERNO NUMBER(15)PRIMARY KEY
);



CREATE TABLE ShoppingMall (
ITEMNO      NUMBER(10)      PRIMARY KEY,
STOCK            NUMBER(5) NOT NULL,
PRICE          NUMBER(10),
STATE     NUMBER(2) ,
CLASSNO           NUMBER(10) NOT NULL,
NAME         VARCHAR2(30) NOT NULL,
DES          VARCHAR2(300),
PICTURE1        BLOB,
PICTURE2        BLOB,
PICTURE3        BLOB,
CONSTRAINT FK_CLASSNO  FOREIGN KEY (CLASSNO) REFERENCES CLASSSTYLE(CLASSNO)
);


CREATE TABLE SHOPORDER (
ORDERNO NUMBER(10) PRIMARY KEY,
MEMBERNO NUMBER(10),
ORDER_DATE TIMESTAMP,
CUSTOMER_ADDRESS VARCHAR2(100),
CUSTOMER_PHNOE VARCHAR2(15),
CUSTOMER_NAME VARCHAR2(15),
CONSTRAINT FK_MEMBERNO  FOREIGN KEY (MEMBERNO) REFERENCES MEMBER(MEMBERNO)
);

CREATE TABLE PROMOTION (
PROMOTIONNO  NUMBER(10)  PRIMARY KEY,
NAME  VARCHAR2(45),
BEGINDATE DATE,
ENDDATE DATE
);

CREATE TABLE PROMOTIONDETAIL (
PROMOTIONNO  NUMBER(10)  ,
ITEMNO           NUMBER(10),
PRICE          NUMBER(10),
constraint PR_SUPPLIER_EX_PK primary key(PROMOTIONNO, ITEMNO),
CONSTRAINT FK_PROMOTIONNO  FOREIGN KEY (PROMOTIONNO) REFERENCES PROMOTION(PROMOTIONNO),
CONSTRAINT FK_CLASSNOS  FOREIGN KEY (ITEMNO) REFERENCES ShoppingMall (ITEMNO)
);


CREATE TABLE ORDERDETAIL (
ORDERNO      NUMBER(10) ,
ITEMNO         NUMBER(10),
ORDERCOUNT NUMBER(5),
constraint PR_SUPPLIER_EX_OR primary key(ORDERNO, ITEMNO),
CONSTRAINT FK_ORDERNO  FOREIGN KEY (ORDERNO) REFERENCES SHOPORDER(ORDERNO),
CONSTRAINT FK_NAME  FOREIGN KEY (ITEMNO) REFERENCES ShoppingMall(ITEMNO)
);

INSERT INTO CLASSSTYLE(CLASSNO, CLASSNAME)  VALUES (1,'水果');
INSERT INTO CLASSSTYLE(CLASSNO, CLASSNAME)  VALUES (2,'肉類');
INSERT INTO CLASSSTYLE(CLASSNO, CLASSNAME)  VALUES (3,'魚類');
INSERT INTO CLASSSTYLE(CLASSNO, CLASSNAME)  VALUES (4,'蔬菜類');

INSERT INTO PROMOTION (PROMOTIONNO,NAME) VALUES(1,'中秋活動');
INSERT INTO PROMOTION (PROMOTIONNO,NAME) VALUES(2,'端午活動');
INSERT INTO PROMOTION (PROMOTIONNO,NAME) VALUES(3,'萬聖節活動');
INSERT INTO PROMOTION (PROMOTIONNO,NAME) VALUES(4,'海鮮自由行');

INSERT INTO PROMOTIONDETAIL (PROMOTIONNO,ITEMNO,PRICE) VALUES(2,10,200);
INSERT INTO PROMOTIONDETAIL (PROMOTIONNO,ITEMNO,PRICE) VALUES(3,12,200);
INSERT INTO PROMOTIONDETAIL (PROMOTIONNO,ITEMNO,PRICE) VALUES(4,9,250);
INSERT INTO PROMOTIONDETAIL (PROMOTIONNO,ITEMNO,PRICE) VALUES(2,6,280);





SELECT PROMOTIONNO,NAME FROM PROMOTION;
SELECT ITEMNO, PRICE FROM PROMOTIONDETAIL;
commit;
DELETE  FROM PROMOTIONDETAIL where ITEMNO = 13;
DELETE FROM ShoppingMall where ITEMNO = 13;

SELECT * FROM SHOPPINGMALL ORDER BY ITEMNO;

INSERT INTO ShoppingMall(ITEMNO, STOCK, PRICE, STATE, CLASSNO, NAME, DES,PICTURE1,PICTURE2,PICTURE3)  VALUES (3,4,100,1,4,'測試','成功嗎',?,?,?);

SELECT COUNT(*) AS TOTAL FROM SHOPPINGMALL;
SELECT * FROM SHOPPINGMALL ORDER BY ITEMNO;

INSERT INTO ShoppingMall(ITEMNO, STOCK, PRICE, STATE, CLASSNO, NAME, DES) 
VALUES (FORSHOPITEM.Nextval,50,100,2,4,'王小明','很棒');

INSERT INTO PRODUCT (PDCLASS, PDNO, PDNAME, DES, PRICE, STOCK, PIC_FORMAT, PICTURE) VALUES ('b', '002', '雪', 'BEAUTY222', '888', '50', '.jpg', empty_blob());
INSERT INTO PRODUCT (PDCLASS, PDNO, PDNAME, DES, PRICE, STOCK, PIC_FORMAT, PICTURE) VALUES ('b', '003', '連', 'BEAUTY333', '777', '50', '.jpg', empty_blob());
INSERT INTO PRODUCT (PDCLASS, PDNO, PDNAME, DES, PRICE, STOCK, PIC_FORMAT, PICTURE) VALUES ('b', '004', '天', 'BEAUTY444', '666', '50', '.jpg', empty_blob());
UPDATE PRODUCT SET STOCK = 50 WHERE PDNO = 001;



***********************************************************************************************************************************
SELECT P.PROMOTIONNO, ITEMNO, PRICE,NAME,BEGINDATE,ENDDATE 
FROM PROMOTIONDETAIL P 
JOIN PROMOTION PT ON P.PROMOTIONNO = PT.PROMOTIONNO ;

SELECT P.PROMOTIONNO,P.ITEMNO,P.PRICE,PT.NAME,BEGINDATE,ENDDATE,SP.NAME AS SHOPNAME
FROM PROMOTIONDETAIL P 
JOIN PROMOTION PT ON (P.PROMOTIONNO = PT.PROMOTIONNO)
JOIN SHOPPINGMALL SP  ON SP.ITEMNO = P.ITEMNO;




FORSHOPITEM.Nextval;

create sequence FORSHOPITEM
minvalue 1
maxvalue 999999999999999999999999999
start with 1
increment by 1
nocache;

SELECT SHOPPINGMALL FROM PRODUCT WHERE ITEMNO = 2;
SELECT PICTURE1 FROM SHOPPINGMALL WHERE ITEMNO = 3;
SELECT PICTURE1 FROM SHOPPINGMALL WHERE ITEMNO = 4;
SELECT PICTURE FROM PRODUCT WHERE PDNO = 9;

屌炸天sql語法
SELECT P.PROMOTIONNO,P.ITEMNO,P.PRICE,PT.NAME,BEGINDATE,ENDDATE,SP.NAME AS SHOPNAME 
FROM PROMOTIONDETAIL P JOIN PROMOTION PT ON (P.PROMOTIONNO = PT.PROMOTIONNO) 
JOIN (SELECT * FROM SHOPPINGMALL WHERE NAME='國民黨')SP  ON SP.ITEMNO = P.ITEMNO


查詢JOIN表格失敗
SELECT P.PROMOTIONNO,P.ITEMNO,P.PRICE,PT.NAME,BEGINDATE,ENDDATE,SP.NAME AS SHOPNAME FROM 
PROMOTIONDETAIL P JOIN PROMOTION PT ON (P.PROMOTIONNO = PT.PROMOTIONNO) JOIN 
(SELECT * FROM SHOPPINGMALL WHERE NAME='海鮮自由行')SP ON SP.ITEMNO = P.ITEMNO;
查詢JOIN表格成功(INT)
SELECT P.PROMOTIONNO,P.ITEMNO,P.PRICE,PT.NAME,BEGINDATE,ENDDATE,SP.NAME AS 
SHOPNAME FROM PROMOTIONDETAIL P JOIN PROMOTION PT ON (P.PROMOTIONNO = PT.PROMOTIONNO) 
JOIN (SELECT * FROM SHOPPINGMALL WHERE ITEMNO=3)SP  ON SP.ITEMNO = P.ITEMNO;
查詢JOIN表格成功(String)
SELECT P.PROMOTIONNO,P.ITEMNO,P.PRICE,PT.NAME,BEGINDATE,ENDDATE,SP.NAME AS 
SHOPNAME FROM PROMOTIONDETAIL P JOIN (SELECT * FROM PROMOTION WHERE NAME='萬聖節活動')PT ON (P.PROMOTIONNO = PT.PROMOTIONNO) 
JOIN (SELECT * FROM SHOPPINGMALL )SP  ON SP.ITEMNO = P.ITEMNO;
